import{S as a,i as s,s as t,M as o,e,a as n,c as r,b as i,m as c,n as p,t as m,d as u,f as l,g as f,h,o as d,r as g,k as x,p as v,q as b,j as y,u as M,v as w,x as j,y as $,C as k,D as C,w as _,A,E as D,I as E}from"./engine.js";import{c as S}from"./skybox.js";import{c as T,a as q}from"./polyhedron.js";import{c as z,a as I}from"./debug.js";import{c as L,l as B,g as F,h as G,a as H,b as J}from"./environment-map-texture.js";import{c as K}from"./specular.js";function N(a){let s,t,h,d;return h=new o({}),{c(){s=e("canvas"),t=n(),r(h.$$.fragment)},m(o,e){i(o,s,e),a[1](s),i(o,t,e),c(h,o,e),d=!0},p:p,i(a){d||(m(h.$$.fragment,a),d=!0)},o(a){u(h.$$.fragment,a),d=!1},d(o){o&&(l(s),l(t)),a[1](null),f(h,o)}}}function O(){}function P(a,s,t){let o,e,n,r,i,c,p;return h(a,g,(a=>t(3,o=a))),h(a,x,(a=>t(4,e=a))),h(a,v,(a=>t(5,n=a))),h(a,b,(a=>t(6,r=a))),h(a,y,(a=>t(7,i=a))),d((async()=>{M(g,o={...o,canvas:c,backgroundColor:w,ambientLightColor:[16777215,.1],toneMappings:[L({exposure:1})]},o),M(y,i={...i,position:[-4.5,.8,-2.5],target:[0,0,0],fov:75},i),p=await B("christmas_photo_studio_01_4k.hdr");const a=F(1),s=await S({typedArray:p.data,convertToCube:G,width:p.width,height:p.height,cubeSize:2048,toneMapping:a}),t=H(p);console.log("environmentMap",t),M(b,r=[s,t],r);const m=T(2,5,q),u=j($()),l=_({diffuse:[1,0,0],metalness:0,program:I()});z({...m,matrix:u,material:l}),k(C({position:[-2,2,2],color:[1,1,1],intensity:5,cutoffDistance:0,decayExponent:2}));const f=J({envMap:t.getTexture,width:t.width,height:t.height,lodMax:t.lodMax});console.log("envMap",f);const h=_({diffuse:[1,1,1],metalness:1,specular:K({roughness:.05,ior:1.5,intensity:1,color:[1,1,1]}),envMap:f});M(v,n=[...n,h],n),M(x,e=[...e,A({...m,matrix:u,material:h})],e),M(g,o={...o,loop:O,enabled:!0},o),D(c,y)})),[c,function(a){E[a?"unshift":"push"]((()=>{c=a,t(0,c)}))}]}class Q extends a{constructor(a){super(),s(this,a,P,N,t,{})}}export{Q as default};
