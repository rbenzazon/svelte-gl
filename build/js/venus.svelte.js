import{O as t,P as s,Q as a,R as e,x as n,y as o,S as r,i,s as c,M as l,e as p,a as f,c as u,b as m,m as h,n as d,t as y,d as w,f as g,g as x,h as F,o as v,r as j,l as $,k as b,p as E,j as A,q as I,z as D,u as M,v as W,C as k,D as B,G as C,H as O,w as J,A as P,E as T,I as q}from"./engine.js";import{c as z}from"./plane.js";import{c as G}from"./texture.js";import{c as H}from"./contact-shadow.js";import{c as L}from"./specular.js";async function Q(r){try{const i=await fetch(r);if(!i.ok)throw new Error(`Failed to fetch OBJ file: ${i.statusText}`);const c=await i.text();return await async function(r){const i=r.split("\n"),c=[],l=[],p=[],f=[],u=[];for(let e=0;e<i.length;e++){const n=i[e];if(n.startsWith("v ")){const[,t,s,a]=n.split(" ");c.push(parseFloat(t),parseFloat(s),parseFloat(a))}if(n.startsWith("vn ")){const[,t,s,a]=n.split(" ");p.push(parseFloat(t),parseFloat(s),parseFloat(a))}if(n.startsWith("vt ")){const[,t,s]=n.split(" ");f.push(parseFloat(t),parseFloat(s))}if(n.startsWith("f ")){const[,e,o,r]=n.split(" "),i=3*(parseInt(e)-1),f=3*(parseInt(o)-1),u=3*(parseInt(r)-1),m=[c[i],c[i+1],c[i+2]],h=[c[f],c[f+1],c[f+2]],d=[c[u],c[u+1],c[u+2]];l.push(...m),l.push(...h),l.push(...d);const y=t([],s([],d,h),s([],m,h));a(y,y),p.push(...y,...y,...y)}}return{attributes:{positions:new Float32Array(l),normals:new Float32Array(p),...f.length>0&&{uvs:new Float32Array(f)},...u.length>0&&{elements:new Uint16Array(u)}},drawMode:e[4],material:{diffuse:[1,1,1],metalness:0},matrix:n(o())}}(c)}catch(t){console.error("Error loading OBJ file:",t)}}function R(t){let s,a,e,n;return e=new l({}),{c(){s=p("canvas"),a=f(),u(e.$$.fragment)},m(o,r){m(o,s,r),t[1](s),m(o,a,r),h(e,o,r),n=!0},p:d,i(t){n||(y(e.$$.fragment,t),n=!0)},o(t){w(e.$$.fragment,t),n=!1},d(n){n&&(g(s),g(a)),t[1](null),x(e,n)}}}function S(){}function U(t,s,a){let e,r,i,c,l,p,f;return F(t,j,(t=>a(2,e=t))),F(t,$,(t=>a(3,r=t))),F(t,b,(t=>a(4,i=t))),F(t,E,(t=>a(5,c=t))),F(t,A,(t=>a(6,l=t))),F(t,I,(t=>a(7,p=t))),v((async()=>{const t=n(o());D(t,t,[0,-1.5,0]),M(j,e={...e,canvas:f,backgroundColor:W,ambientLightColor:[16777215,.15]},e);const s=H(t,1,10,10,1024,128,.5),{getTexture:a}=s;M(I,p=[s],p),M(A,l={...l,position:[0,5,-5],target:[0,2,0],fov:75},l);const u=k(B({position:[-2,3,-3],color:[1,1,1],intensity:20,cutoffDistance:0,decayExponent:2})),m=k(B({position:[2,-1,-1],color:[1,1,1],intensity:20,cutoffDistance:0,decayExponent:2})),h=k(B({position:[-1,3,4],color:[1,1,1],intensity:10,cutoffDistance:0,decayExponent:2})),d=z(10,10,1,1),y=await G({textureBuffer:a,type:"diffuse"}),w=J({diffuse:[1,1,1],metalness:0,diffuseMap:y,transparent:!0}),g=await Q("models/venus.obj"),x=n(o());C(x,x,Math.PI),O(x,x,[.003,.003,.003]),D(x,x,[0,-450,0]);const F=J({...g.material,specular:L({roughness:.45,ior:1.5,intensity:1,color:[1,1,1]})});M(E,c=[...c,F,w],c),M(b,i=[...i,P({...d,matrix:t,material:w}),P({...g,matrix:x,material:F})],i),M($,r=[...r,u,m,h],r),M(j,e={...e,loop:S,enabled:!0},e),T(f,A)})),[f,function(t){q[t?"unshift":"push"]((()=>{f=t,a(0,f)}))}]}class K extends r{constructor(t){super(),i(this,t,U,R,c,{})}}export{K as default};
