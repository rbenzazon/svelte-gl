import{E as t,w as a,F as s,G as e,H as r,S as n,i as o,s as i,M as l,e as c,a as u,c as f,b as p,m,n as h,t as x,d,f as w,g as y,h as F,o as g,r as b,j as v,k as A,l as $,v as j,x as E,y as I,z as M,A as B,u as W,I as k,B as C,C as D,D as J}from"./Menu-BA3sIFm9.js";import{c as O}from"./plane-BsodfT6s.js";import{c as T}from"./texture-bGUDcV7H.js";import{c as z}from"./contact-shadow-DtNIYg5F.js";async function G(n){try{const o=await fetch(n);if(!o.ok)throw new Error(`Failed to fetch OBJ file: ${o.statusText}`);const i=await o.text();return await async function(n,o){const i=n.split("\n"),l=[],c=[],u=[],f=[],p=[],m={attributes:{},drawMode:t[4],material:{diffuse:[1,1,1],metalness:0},matrix:a(new Float32Array(16))};for(let t=0;t<i.length;t++){const a=i[t];if(a.startsWith("v ")){const[,t,s,e]=a.split(" ");l.push(parseFloat(t),parseFloat(s),parseFloat(e))}if(a.startsWith("vn ")){const[,t,s,e]=a.split(" ");u.push(parseFloat(t),parseFloat(s),parseFloat(e))}if(a.startsWith("vt ")){const[,t,s]=a.split(" ");f.push(parseFloat(t),parseFloat(s))}if(a.startsWith("f ")){const[,t,n,o]=a.split(" "),i=3*(parseInt(t)-1),f=3*(parseInt(n)-1),p=3*(parseInt(o)-1),m=[l[i],l[i+1],l[i+2]],h=[l[f],l[f+1],l[f+2]],x=[l[p],l[p+1],l[p+2]];c.push(...m),c.push(...h),c.push(...x);const d=s([],e([],x,h),e([],m,h));r(d,d),u.push(...d,...d,...d)}}c.length>0&&(m.attributes.positions=new Float32Array(c));u.length>0&&(m.attributes.normals=new Float32Array(u));f.length>0&&(m.attributes.uvs=new Float32Array(f));p.length>0&&(m.attributes.elements=new Uint16Array(p),console.log("indices used",p.slice(0,3)));return m}(i)}catch(t){console.error("Error loading OBJ file:",t)}}function H(t){let a,s,e,r;return e=new l({}),{c(){a=c("canvas"),s=u(),f(e.$$.fragment)},m(n,o){p(n,a,o),t[1](a),p(n,s,o),m(e,n,o),r=!0},p:h,i(t){r||(x(e.$$.fragment,t),r=!0)},o(t){d(e.$$.fragment,t),r=!1},d(r){r&&(w(a),w(s)),t[1](null),y(e,r)}}}function L(){}function P(t,s,e){let r,n,o,i,l;return F(t,b,(t=>e(2,r=t))),F(t,v,(t=>e(3,n=t))),F(t,A,(t=>e(4,o=t))),F(t,$,(t=>e(5,i=t))),g((async()=>{const t=a(new Float32Array(16));j(t,t,[0,-1.5,0]),E(b,r={...r,canvas:l,backgroundColor:I,ambientLightColor:[16777215,.1]},r);const s=z(t,1,10,10,1024,128,.5),{getTexture:e}=s;E($,i=[s],i),E(A,o={position:[0,5,-5],target:[0,2,0],fov:75},o);const c=M(B({position:[-2,3,-3],color:[1,1,1],intensity:20,cutoffDistance:0,decayExponent:2})),u=M(B({position:[2,-1,-1],color:[1,1,1],intensity:20,cutoffDistance:0,decayExponent:2})),f=a(new Float32Array(16));j(f,f,[3,0,0]),W(f,f,[.1,.1,.1]);const p=O(10,10,1,1),m={diffuse:[1,1,1],metalness:0,diffuseMap:await T({textureBuffer:e,type:"diffuse"}),transparent:!0},h=await G("venus.obj");h.matrix=k(h.matrix,h.matrix,Math.PI),h.matrix=W(h.matrix,h.matrix,[.003,.003,.003]),h.matrix=j(h.matrix,h.matrix,[0,-450,0]),E(v,n=[...n,C({...p,matrix:t,material:m}),C(h),c,u],n),E(b,r={...r,loop:L,enabled:!0},r),D(l,A)})),[l,function(t){J[t?"unshift":"push"]((()=>{l=t,e(0,l)}))}]}class S extends n{constructor(t){super(),o(this,t,P,H,i,{})}}export{S as default};
