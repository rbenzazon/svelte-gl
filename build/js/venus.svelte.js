import{A as t,l as a,B as s,C as e,D as n,S as r,i as o,s as i,e as l,a as c,n as u,d as p,c as f,o as m,r as d,b as h,f as x,g as w,t as y,h as g,j as F,k as b,m as v,p as A,q as E,u as I,v as j,w as B,E as M,x as W,y as k,z as C}from"./texture-B1gA2w_v.js";import{l as D,t as J,g as O,c as P,a as T,b as q,d as z,e as L}from"./gltf-loader-DiZWQKLS.js";async function S(r){try{const o=await fetch(r);if(!o.ok)throw new Error(`Failed to fetch OBJ file: ${o.statusText}`);const i=await o.text();return await async function(r,o){const i=r.split("\n"),l=[],c=[],u=[],p=[],f=[],m={attributes:{},drawMode:t[4],material:{diffuse:[1,1,1],metalness:0},matrix:a(new Float32Array(16))};for(let t=0;t<i.length;t++){const a=i[t];if(a.startsWith("v ")){const[,t,s,e]=a.split(" ");l.push(parseFloat(t),parseFloat(s),parseFloat(e))}if(a.startsWith("vn ")){const[,t,s,e]=a.split(" ");u.push(parseFloat(t),parseFloat(s),parseFloat(e))}if(a.startsWith("vt ")){const[,t,s]=a.split(" ");p.push(parseFloat(t),parseFloat(s))}if(a.startsWith("f ")){const[,t,r,o]=a.split(" "),i=3*(parseInt(t)-1),p=3*(parseInt(r)-1),f=3*(parseInt(o)-1),m=[l[i],l[i+1],l[i+2]],d=[l[p],l[p+1],l[p+2]],h=[l[f],l[f+1],l[f+2]];c.push(...m),c.push(...d),c.push(...h);const x=s([],e([],h,d),e([],m,d));n(x,x),u.push(...x,...x,...x)}}c.length>0&&(m.attributes.positions=new Float32Array(c));u.length>0&&(m.attributes.normals=new Float32Array(u));p.length>0&&(m.attributes.uvs=new Float32Array(p));f.length>0&&(m.attributes.elements=new Uint16Array(f),console.log("indices used",f.slice(0,3)));return m}(i)}catch(t){console.error("Error loading OBJ file:",t)}}function U(t){let a;return{c(){a=l("canvas")},m(s,e){c(s,a,e),t[1](a)},p:u,i:u,o:u,d(s){s&&p(a),t[1](null)}}}function $(){performance.now()}function G(t,s,e){let n,r,o,i,l;return f(t,d,(t=>e(2,n=t))),f(t,h,(t=>e(3,r=t))),f(t,x,(t=>e(4,o=t))),f(t,w,(t=>e(5,i=t))),m((async()=>{const t=await D("models/v2/md-blend6-mdlvw.gltf","models/v2/md-blend6-mdlvw.bin");let s,e;J(t.scene,(t=>{null!=t.position?s=t:null!=t.camera&&(e=t)}));const c=O(e),u=P(e);y(u.position,u.position,c);const p=O(s);g(p,p,Math.PI),F(p,p,[200,200,200]),b(p,p,[0,0,-500]),s.matrix=p;T(t,s).matrix=p;const f=a(new Float32Array(16));b(f,f,[0,-1.5,0]),v(d,n={...n,canvas:l,backgroundColor:A,ambientLightColor:[16777215,.1]},n);const m=q(f,1,10,10,1024,128,.5),{getTexture:k}=m;v(w,i=[m],i),v(x,o={position:[0,5,-5],target:[0,2,0],fov:75},o),z();const U=E(1,5,C),G=I(j({position:[-2,3,-3],color:[1,1,1],intensity:20,cutoffDistance:0,decayExponent:2})),H=I(j({position:[2,-1,-1],color:[1,1,1],intensity:20,cutoffDistance:0,decayExponent:2})),K=a(new Float32Array(16));b(K,K,[3,0,0]),F(K,K,[.1,.1,.1]);const N=L(10,10,1,1),Q=await B({textureBuffer:k,type:"diffuse"});await B({url:"transparent-texture.png",type:"diffuse"});const R={diffuse:[1,1,1],metalness:0,diffuseMap:Q,transparent:!0},V=await S("venus.obj");V.matrix=M(V.matrix,V.matrix,Math.PI),V.matrix=F(V.matrix,V.matrix,[.003,.003,.003]),V.matrix=b(V.matrix,V.matrix,[0,-450,0]),v(h,r=[...r,{...U,matrix:K,material:{diffuse:[1,1,.5],metalness:0,opacity:.5}},{...N,matrix:f,material:R},V,G,H],r),v(d,n={...n,loop:$,enabled:!0},n),W(l,x)})),[l,function(t){k[t?"unshift":"push"]((()=>{l=t,e(0,l)}))}]}class H extends r{constructor(t){super(),o(this,t,G,U,i,{})}}export{H as default};
