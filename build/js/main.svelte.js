import{S as a,i as s,s as t,M as o,e as n,a as e,c as i,b as r,m as c,n as f,t as m,d as l,f as p,g as d,h as u,o as g,r as x,l as y,k as b,p as h,j,q as v,N as w,K as $,H as C,z as D,x as E,y as M,u as k,v as I,C as q,D as z,A,E as B,I as H,w as K}from"./engine.js";import{c as L,a as N}from"./polyhedron.js";import{c as P}from"./plane.js";import{c as S}from"./texture.js";import{c as T}from"./contact-shadow.js";import{l as F,m as G,i as J,a as O,g as Q,b as R,c as U}from"./gltf-loader.js";import"./specular.js";function V(a){let s,t,u,g;return u=new o({}),{c(){s=n("canvas"),t=e(),i(u.$$.fragment)},m(o,n){r(o,s,n),a[1](s),r(o,t,n),c(u,o,n),g=!0},p:f,i(a){g||(m(u.$$.fragment,a),g=!0)},o(a){l(u.$$.fragment,a),g=!1},d(o){o&&(p(s),p(t)),a[1](null),d(u,o)}}}function W(){}function X(a,s,t){let o,n,e,i,r,c,f;return u(a,x,(a=>t(2,o=a))),u(a,y,(a=>t(3,n=a))),u(a,b,(a=>t(4,e=a))),u(a,h,(a=>t(5,i=a))),u(a,j,(a=>t(6,r=a))),u(a,v,(a=>t(7,c=a))),g((async()=>{const a=await F("models/v2/md-blend6-mdlvw.gltf","models/v2/md-blend6-mdlvw.bin"),s=G(a.scene),t=s.find(J),m=s.find(O),l=Q(m),p=R(m);w(p.position,p.position,l);const d=Q(t);$(d,d,Math.PI),C(d,d,[200,200,200]),D(d,d,[0,0,-500]);const u=U(a,t),g=E(M());D(g,g,[0,-1.2,0]),k(x,o={...o,canvas:f,backgroundColor:I,ambientLightColor:[16777215,.1]},o);const H=T(g,1,10,10,1024,64,.9),{getTexture:V}=H;k(v,c=[H],c),k(j,r={...r,position:[0,5,-5],target:[0,1,0],fov:75},r);const X=L(1,5,N),Y=q(z({position:[-2,3,-3],color:[1,1,1],intensity:20,cutoffDistance:0,decayExponent:2})),Z=q(z({position:[2,-1,-1],color:[1,1,1],intensity:20,cutoffDistance:0,decayExponent:2})),_=E(M());D(_,_,[3,0,0]),C(_,_,[.1,.1,.1]);const aa=P(10,10,1,1),sa=await S({textureBuffer:V,type:"diffuse"}),ta=K({diffuse:[1,1,1],metalness:0,diffuseMap:sa,transparent:!0}),oa=K({diffuse:[1,1,.5],metalness:0,opacity:.5}),na=K(u.material);k(h,i=[...i,ta,oa,na],i),k(b,e=[...e,A({...u,matrix:d,material:na}),A({...X,matrix:_,material:oa}),A({...aa,matrix:g,material:ta})],e),k(y,n=[...n,Y,Z],n),k(x,o={...o,loop:W,enabled:!0},o),B(f,j)})),[f,function(a){H[a?"unshift":"push"]((()=>{f=a,t(0,f)}))}]}class Y extends a{constructor(a){super(),s(this,a,X,V,t,{})}}export{Y as default};
