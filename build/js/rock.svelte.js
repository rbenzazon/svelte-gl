import{S as e,i as s,s as a,M as t,e as n,a as o,c as i,b as r,m as l,n as c,t as m,d as f,f as p,g as u,h as d,o as g,p as h,r as w,l as y,j as x,k as M,q as b,A as k,B as j,H as v,y as A,z as $,x as I,E as C,I as D,C as E,D as P,F as z,J as L,K as S,w as T,G as q,L as B}from"./engine.js";import{l as F,m as G,i as H,b as J}from"./gltf-loader.js";import{c as K}from"./specular.js";import{c as N}from"./texture.js";import{c as O}from"./plane.js";import{c as Q,g as R,h as U,a as V,b as W}from"./environment-map-texture.js";import{l as X}from"./rgbe-loader.js";import{c as Y}from"./skybox.js";function Z(e){let s,a,d,g;return d=new t({}),{c(){s=n("canvas"),a=o(),i(d.$$.fragment)},m(t,n){r(t,s,n),e[1](s),r(t,a,n),l(d,t,n),g=!0},p:c,i(e){g||(m(d.$$.fragment,e),g=!0)},o(e){f(d.$$.fragment,e),g=!1},d(t){t&&(p(s),p(a)),e[1](null),u(d,t)}}}function _(e,s,a){let t,n,o,i,r,l,c,m,f,p;d(e,h,(e=>a(6,t=e))),d(e,w,(e=>a(7,n=e))),d(e,y,(e=>a(8,o=e))),d(e,x,(e=>a(9,i=e))),d(e,M,(e=>a(10,r=e))),d(e,b,(e=>a(11,l=e)));let u=0;function Z(){u+=.01;const e=t.position;e[1]+=.01;const s=t.target;s[1]+=.01,k(h,t={...t,position:e,target:s},t);const a=L(m);a.position[1]+=.01;const n=L(f);n.position[1]+=.01,m.set({...a}),f.set({...n});for(let t=0;t<15;t++){const e=.001*performance.now()+t*Math.PI*2/15,s=4,a=Math.cos(e)*s,n=Math.sin(e)*s,o=A($());I(o,o,[a,n+u+4,0]),S(o,o,.003*performance.now()+t*Math.PI*2/15),T(o,o,[.6,.6,.6]),p.matrices.setInstance(t,o)}}return g((async()=>{k(w,n={...n,canvas:c,backgroundColor:j,ambientLightColor:[16777215,.1],toneMappings:[Q({exposure:1})]},n),k(h,t={...t,position:[0,3,21],target:[0,3,0],fov:36},t);const e=await X("skyboxes/rogland-clear-night-4k.hdr"),s=R(1),a=await Y({typedArray:e.data,convertToCube:U,width:e.width,height:e.height,cubeSize:2048,toneMapping:s}),u=V(e);k(b,l=[a,u],l);const d=W({envMap:u.getTexture,width:u.width,height:u.height,lodMax:u.lodMax}),g=await F("models/rock-left.gltf","models/rock-left.bin"),L=G(g.scene).find(H),S=J(g,L),T=await N({url:"textures/rock-diffuse.jpg",type:"diffuse"}),q=await N({url:"textures/rock-normal.png",type:"normal"}),_=v({metalness:S.material.metalness,diffuse:[.67,.68,.81],specular:K({roughness:1,ior:1.4,intensity:.5,color:[1,1,1]}),diffuseMap:T,normalMap:q,envMap:d});const ee=A($());let se=new Array(60).fill(0).map(((e,s)=>{let a=B(ee);return I(a,a,[-10,2*s-4,0]),a}));delete S.matrix;const ae=C({...S,material:_,instances:60,matrices:se}),te=await F("models/rock-right.gltf","models/rock-right.bin"),ne=G(te.scene).find(H),oe=J(te,ne),ie=A($());let re=new Array(60).fill(0).map(((e,s)=>{let a=B(ie);return I(a,a,[10,2*s-4,0]),a}));delete oe.matrix;const le=C({...oe,material:_,instances:60,matrices:re}),ce=await F("models/ennemi1.gltf","models/ennemi1.bin"),me=G(ce.scene).find(H),fe=J(ce,me),pe=await N({url:"models/ennemi1-diffuse.png",type:"diffuse"}),ue=await N({url:"models/ennemi1-roughness.png",type:"roughness"}),de=v({...fe.material,metalness:.8090909123420715,specular:K({roughness:1,ior:1.4,intensity:.8,color:[1,1,1]}),diffuse:[1,1,1],diffuseMap:pe,roughnessMap:ue,envMap:d}),ge=new Array(15).fill(0).map(((e,s)=>A($())));delete fe.matrix,p=C({...fe,matrices:ge,instances:15,material:de});const he=O(100,100,1,1),we=await N({url:"textures/background.jpg",type:"diffuse"}),ye=v({diffuse:[.67,.68,.81],metalness:0,diffuseMap:we}),xe=A($());I(xe,xe,[0,0,-70]),D(xe,xe,Math.PI/2);const Me=new Array(5).fill(0).map(((e,s)=>{let a=B(xe);return I(a,a,[0,0,100*-s]),a})),be=C({...he,material:ye,instances:5,matrices:Me});m=E(P({color:[.996078431372549,.9529411764705882,.6627450980392157],intensity:4,position:[0,9,3],cutoffDistance:120,decayExponent:.001})),f=E(P({position:[-3,-3,1],color:[.6313725490196078,.6235294117647059,.996078431372549],intensity:3,cutoffDistance:15,decayExponent:.25})),k(M,r=[...r,_,de,ye],r),k(x,i=[...i,ae,le,p,be],i),k(y,o=[...o,m,f],o),k(w,n={...n,loop:Z,enabled:!0},n),z(c,h)})),[c,function(e){q[e?"unshift":"push"]((()=>{c=e,a(0,c)}))}]}new class extends e{constructor(e){super(),s(this,e,_,Z,a,{})}}({target:document.body});
